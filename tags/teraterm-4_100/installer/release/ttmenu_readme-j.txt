--------------------------------------------------------------------------------
                               Tera Term支援ツール
                           Tera Term Menu Version 0.94r2

                            S. Hayakawa  Jan 7, 2003

                        Copyright (C) 1997-2003  S.Hayakawa
                                All Rights Reserved.
--------------------------------------------------------------------------------
目次
  1. 概要
  2. 著作権等
  3. 動作環境
  4. インストール
  5. 使用方法
  6. よくある質問
  7. 備考
  8. 更新履歴
  9. 謝辞
--------------------------------------------------------------------------------
1. 概要

TeraTerm Menuは Tera Term Proの使用を支援するためのソフトです。
タスクトレイに常駐し、登録されたホストへの自動ログインを実現します。

また簡単なアプリケーションランチャーとしても御使用いただけます。

--------------------------------------------------------------------------------
2. 著作権等

このプログラムはフリーソフトウェアです。
著作権は、作者（早川信平）が保持します。
このプログラムの使用による、いかなる損害に対しても、作者は責任を負いません。

作者へ要望や質問、バグの報告などは以下までお願い致します。

shinpei@bb.wakwak.com

また TeraTerm Menuの最新版は以下の URLより入手いただけます。

http://www.bb.wakwak.com/~shinpei/freesoft/

--------------------------------------------------------------------------------
3. 動作環境

TeraTerm Menuを御使用いただくには、Tera Term Pro version 2.2以降が必要です。
またTeraTerm Menuは以下の OS環境で御使用いただける事が確認されております。

    Microsoft Windows 95/98/ME
    Microsoft Windows NT4.0
    Microsoft Windows 2000/XP

--------------------------------------------------------------------------------
4. インストール

圧縮ファイルを解凍後、ttpmenu.exeを適当なところへ保存して下さい。

--------------------------------------------------------------------------------
5. 使用方法

(1) ttpmenu.exeをダブルクリックするなどして実行して下さい。
    するとタスクトレイに TeraTermアイコンが登録されます。

(2) タスクトレイに登録された Tera Termアイコンをマウスで、右クリックして下さい。
    するとポップアップメニューは開きますので、その中の「リスト編集」を選択して
    下さい。すると「リスト編集」ダイアログが開きます。

(3) ここで自動ログイン等の設定を行います。各項目の設定後は左向き矢印のボタンを
    押して登録して下さい。なお右向き矢印のボタンを押すと登録が削除されます。
    各項目の設定内容は以下の通りです。

    (a) 登録名

        設定の名前を入力します。なお名前に \ は使えません。

    (b) 自動ログイン

        ホストへの自動ログインをするマクロファイルを自動生成し、そのファイルを
        TeraTermの /Mオプションにより実行します。

        ・ホスト名  ：ログインしたいホスト名を入力して下さい。
        ・ユーザ名  ：ログインするユーザ名を入力して下さい。なお「ユーザ名」と
                      表示されているボタンを OFF状態にすると、自動ログイン時に
                      ユーザ名の自動入力は行われません。
        ・パスワード：ログインするユーザ名のパスワードを入力して下さい。なお
                     「パスワード」と表示されているボタンを OFF状態にすると、
                      自動ログイン時にユーザ名の自動入力は行われません。


     (c) マクロファイルを指定して実行

         指定されたマクロファイルを TeraTermの /Mオプションにより実行します。

        ・エディットボックスにマクロファイルを指定して下さい。なお詳細項目は
          自動ログインと同様です。（プロンプトのみ無効）

     (d) 起動のみ

         TeraTermを起動します。また詳細で任意のアプリケーションを設定することに
         より、簡単なアプリケーションランチャーとしても御使用いただけます。
         なお、起動するアプリケーションの設定は「(e) 詳細」にて説明します。

     (e) 詳細設定

         詳細な設定をしたい場合に御使用下さい。
            ・起動アプリ  ：御使用したい TeraTermを指定します。
            ・オプション  ：起動時のオプションや引数を指定します。
            ・設定ファイル：御使用したい設定ファイルを指定します。
            ・ログファイル：Tera Term のログを保存するファイルを指定します。
            ・プロンプト  ：ログインプロンプト、パスワードプロンプトを指定
                            します。
         詳細設定を行った際、必ず登録ボタン（三角のボタン）を押して保存して
         下さい。

     (f) 起動時に実行

         TeraTerm Menu 起動時に当該の設定を実行します。

     (g) ttsshを使う

         起動するアプリケーションが ttssh.exeになります。なお明示的にパスを指定
         しない限り ttssh.exeのパスは %TeraTermのインストールパス%\ttssh.exeと
         なります。

         ※ 上記はあくまで実行ファイルが ttssh.exeになるだけの機能なので、ttssh
            による SSHプロトコルでの自動ログインには対応していません。

(4) 設定が終わった後、ポップアップメニュー内の「実行」にマウスカーソルを合わせる
    と設定一覧のポップアップメニューが表示されます。ここでお好きな設定を選択して
    いただくことにより、実行することができます。

(5) ポップアップメニュー内の「表示」にマウスカーソルを合わせると、設定一覧ポップ
    アップメニューの表示設定等ができます。この設定は TeraTerm Menuを終了時に
    自動的に現在の状態を保存いたします。
    なお表示設定の項目は以下の通りです。

    ・大きいアイコンで表示
        チェックすると設定一覧のポップアップメニューにあるアイコンが大きいアイコ
        ンで表示されます。（デフォルトは未チェック）
    ・フォントを指定
        設定一覧のポップアップメニューのフォントを指定します。
    ・右クリックでリスト表示
        チェックするとタスクトレイのアイコンを左クリックしたとき、設定一覧のポッ
        プアップメニューが表示されます。なお未チェックの場合は、右クリックと同様
        の動作をします。
    ・リスト表示ホットキー(Ctl+Alt+M)
        ホットキーによるリスト表示を有効にします。

--------------------------------------------------------------------------------
6. よくある質問

    Q1. TeraTerm Menuの設定はどこに保存されているか？
    A1. 下記のレジストリにすべて保存されています。
          HKEY_CURRENT_USER\Software\ShinpeiTools\TTermMenu
        他マシンに情報を持っていきたい場合は、上記のキーをレジストリエディタ等
        でファイルに保存して、他マシンでリストアすれば情報は移行されます。
        ※ レジストリの編集は自己責任の元に行って下さい。
           ファイルのパス等もすべて旧マシンの情報そのままですのでご注意下さい。

    Q2. 「ttsshを使う」チェックボックスをチェックしても、ttsshで自動ログインが
        できない。
    A2. 「ttsshを使う」チェックボックスはあくまで起動アプリが ttssh.exeになる
        だけであって、ttsshの自動ログインには対応していません。

        ※ 余談ですが、私自身は ssh2プロトコルを使いたいという事もあって、
           ローカルホストに cygwin(http://www.cygwin.com/)を入れて、ローカル
           ホストにログインして、そこから opensshで指定ホストにログインする
           マクロを作成して実行しています。
           （cygwinインストール時にopenssh,inetd,telnetdが必要）
           ちなみに、そのマクロは下記のような感じです。
           ------------------------------------------------------------
           ; SSHでリモートログインするホストの名前
           Hostname         = 'hoge.hoge.jp'
           
           ; ローカルログインの設定
           UsernamePrompt   = 'login:'
           Username         = 'foo'
           PasswordPrompt   = 'Password:'
           getpassword 'C:\SSH-login\passwd.dat' 'localhost' Password
           
           ; ローカルログインの実行
           connect 'localhost'
           wait    UsernamePrompt
           sendln  Username
           wait    PasswordPrompt
           sendln  Password
           
           ; リモートログインの設定
           Prompt       = '[foo@hoge foo]#'
           SSHlogin     = '/usr/local/bin/ssh '
           Title        = 'OpenSSH '
           strconcat SSHlogin Hostname
           strconcat Title Hostname
           
           ; リモートログインの実行
           settitle Title
           wait     Prompt
           sendln   SSHlogin
           ------------------------------------------------------------
           但し、ちゃんと logoutしないで Tera Termのウインドウを閉じると、
           bash.exeや ssh.exeのプロセスが残ってしまうなど、多少問題あり。
           他の方法としては、ポートフォワード＆telnetなどの方法もありますが...
           やはり、ttssh2（できればログインの際のダイアログがないやつ）が
           欲しい (^^;;

    Q3. リストを任意の順番に並べたい。
    A3. TeraTerm Menu自身では今のところ並べ替えに対応していません。
        但し、NT/2000/XPの場合、登録名の前に数字等を入れることによって、ある
        程度順位付けする事ができます。
          例. 登録名->「01.hoge」

    Q4. 自動ログイン時には、どのようなマクロを生成・実行しているのか？
    A4. 多少修正はしてありますが、基本的には Tera Term Proに同梱してある
          login.ttl
        というサンプルのマクロファイルの内容とほぼ同じものを実行しています。
        ※ 結構簡単なマクロです。

    Q5. 自動ログイン後に、任意のコマンドを実行したい。
    A5. 現在のところ、できません。
        どうしても実行したい場合は、A4にある login.ttlを編集したマクロファイル
        を「マクロファイルを指定して実行」モードで実行する事で対処できます。

--------------------------------------------------------------------------------
7. 備考

    マクロの実行途中で TeraTermを終了させた場合マクロファイル（ttm****.tmp）が
    テンポラリフォルダに残る場合がありますのでご注意下さい。

    付属のソースのプロジェクトでをコンパイルする場合、Visual C 5.0以上、
    Win32 Application / Releaseで行って下さい。

    Tera Termの作者である寺西高さんのご好意により、Tera Term Pro Version2.3の
    アイコンを使用させていただいています。

--------------------------------------------------------------------------------
8. 更新履歴

TeraTerm Menu 0.94 Release 2 (2003.1.7)
・エクスプローラが落ちて再起動したときなどに、タスクトレイにあるアイコンが
  失われてしまう問題を修正
・その他小修正

TeraTerm Menu 0.94 Release 1 (2001.11.1)
・「起動時に実行」オプションを追加
・ホットキーによるリスト表示を追加
・Tera Term のログ保存オプションを追加
・リスト編集ダイアログのデザインなどを変更
・自動ログイン用のテンポラリマクロファイルの名前を動的に生成するよう修正

TeraTerm Menu 0.93 Release 4 (1999.4.19)
・新規インストール直後にメニューの色がおかしく表示される不具合を修正
・リスト編集ダイアログのデザインなどを変更
・その他小修正

TeraTerm Menu 0.93 Release 3 (1998.12.14)
・フォント設定ダイアログでキャンセルしたにも関わらずフォントが変更されてしまう
  という不具合を修正

TeraTerm Menu 0.93 Release 2 (1998.12.14)
・詳細設定をせずに登録すると登録が失敗するという不具合を修正

TeraTerm Menu 0.93 (1998.12.10)
・タスクトレイのアイコンを左クリックしたときに設定一覧のポップアップメニューが
  表示されるように変更。（設定により変更可能）
・ttsshの使用をチェックボックスで指定できるように変更
・設定一覧に登録がない場合に「(なし)」という表示をするように変更
・Windowsの終了時に表示設定が保存されないという不具合を修正

TeraTerm Menu 0.93β2 (1998.12.8)
・設定一覧のポップアップメニューのフォントを指定できるように変更
・設定ダイアログで設定を追加したとき、追加した設定でない設定にフォーカスが
  いってしまうことがあるという不具合を修正

TeraTerm Menu 0.93β (1998.12.4) 
・設定一覧のポップアップメニューを独立したポップアップメニューに変更 
・設定一覧のポップアップメニューおよび設定ダイアログ内の設定リストにアイコンを
  表示
・ファイルの参照ダイアログでショートカットも指定できるように修正 
・設定ダイアログの一部にツールチップを追加 
・設定ダイアログで設定を追加したとき、追加した設定にフォーカスが行くように修正
・アイコンをTeraTermの最新アイコンに変更 

 TeraTerm Menu 0.90β (1998.11.21) 
・マクロファイルを指定しての実行を追加 
・詳細設定により、オプション指定や自動ログオン時のプロンプトの設定を追加
・詳細設定で起動アプリケーションを指定できるように変更 
・「ttpmenuについて」ダイアログを追加 
・TeraTermの直接起動を削除 
・自動ログインマクロの実行をttpmacro.exeで実行していたのを、ttermpro.exeで
  実行するよう変更 
・Windows 95において、設定ダイアログを２回開くとTeraTerm Menuが落ちてしまう
  ことがあるという不具合を修正 

--------------------------------------------------------------------------------
9. 謝辞

    このソフトを作るきっかけ及びアドバイスをいただいた白水啓章さん、Tera Term
    という素晴らしいソフトをこの世に送り出してくれ、またこのソフトの改良の際
    アドバイス等をいただいた寺西高さんに感謝致します。

    また実際にこのソフトを使用していただき、色々なアドバイスや不具合報告をして
    いただいた皆様、ありがとうございました。

--------------------------------------------------------------------------------
