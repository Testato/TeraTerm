<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
  <title>setexitcode</title>
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="../../style.css" type="text/css">
</head>

<body>


<h1>setexitcode</h1>

<p>
MACRO の終了コードを設定する。
</p>

<pre class="macro-syntax">
setexitcode &lt;exit code&gt;
</pre>

<h2>解説</h2>

<h3>Windows 98/Me の場合</h3>

<p>
MACRO がバッチファイルからコマンドライン "start /w ttpmacro &lt;ttl filename&gt;" (オプション /w が必要)によって実行された場合、終了コードを DOS コマンド "if errorlevel n" で調べることができる。
</p>

<h3>Windows NT/2000/XP の場合</h3>

<p>
MACRO がバッチファイルからコマンドライン "ttpmacro &lt;ttl filename&gt;" によって実行された場合、終了コードを DOS コマンド"if errorlevel n" で調べることができる。
</p>

<h2>例</h2>

<pre class="macro-example">
----- バッチファイル "test.bat" (Win 98/Me の場合) ------
rem "start /w" コマンドで MACRO を実行
start /w ttpmacro test.ttl
rem もし終了コードが1以上ならメッセージを表示
if errorlevel 1 echo Error!
----- "test.bat" の終わり ---------

----- バッチファイル "test.bat" (Win NT/2000/XP の場合) ------
rem MACRO を実行、"start" コマンドは不必要
ttpmacro test.ttl
rem もし終了コードが1以上ならメッセージを表示
if errorlevel 1 echo Error!
----- "test.bat" の終わり ---------

----- マクロファイル "test.ttl" ----
; 終了コードを 1 にする。
setexitcode 1
----- "test.ttl" の終わり ----------
</pre>

</body>
</html>
