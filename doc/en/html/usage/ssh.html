<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>SSH connection</title>
    <META http-equiv="Content-Style-Type" content="text/css">
    <link rel="stylesheet" href="../style.css" type="text/css">
  </head>

  <body>
    <h1>SSH connection</h1>

    <p>
      Description of SSH connection which is a feature of Tera Term. 
      When the TTSSH module is installed, Tera Term supports the SSH connection.
    </p>

    <h2><a name="prerequisite">Prerequisite</a></h2>

    <p>
      SSH is composed of two protocols, namely SSH1 and SSH2. Be careful that SSH2 is NOT upward compatible of SSH1. These protocols should be chosen carefully according to the host to be connected. TTSSH supports both protocols.
    </p>

    <p>
      There are several ways of connection of SSH as follows      <ul>
	<li>Password authentication</li>
	<li>Key-pair (Public Key and Private key) authentication</li>
	<li>rhosts authentication for SSH1</li>
	<li>challenge/response (SSH1), keyboard-interactive (SSH2) authentication</li>
      </ul>
      In this document, we will describe Password authentication and Key-pair authentication which would be most widely used.    </p>

    <h2><a name="connproc">Procedure of connection</a></h2>

    <p>
      When Tera Term is activated, the following dialog will let you choose login procedure.
    </p>
    <div class="img"><img src="../image/NewConnection.png" alt="connection dialog"></div>
    <p>
      When using SSH, you should change SSH version in a default parameter. Make sure that it is synchronized to the host to be connected.
    </p>

    <p>
      Once connected, then you will be prompted to select authentication method in a dialog.    </p>
    <div class="img"><img src="../image/Authentication.png" alt="Authentication method"></div>
    <p>
      If you want to use Password authentication, then make sure that [Use plain password to log in] is chcked and type in username and password. If they are correct, you can login.<br>
      When using Key-pair authentication, check [RSA/DSA key to log in] (second from the top line) and click [Private key file:] to specify Private key file. Then type in username and Private key pass phrase.
    </p>

    <h2><a name="securitywarning">Security Warning</a></h2>

    <h3><a name="known_hosts">ssh_known_hosts file</a></h3>

    <p>On SSH connection, Tera Term searches the server host key into the ssh_known_hosts file. If the host key can not be found, the security warning is shown.<br />
       The result is described below.</p>

    <ul>
      <li>No host key in ssh_known_hosts.</li>
      <li>Mismatching the host key type found in ssh_known_hosts.</li>
      <li>Mismatching the host key found in ssh_known_hosts.</li>
      <li>Matching the host key found in ssh_known_hosts(not warning).</li>
    </ul>

<!--
    <p>警告が表示された場合には、意図しないサーバに接続しているか中間者攻撃に遭っている可能性があります。<br />
       しかし、始めてサーバに接続するときや、サーバの再インストールなどにより SSH サーバのホスト鍵が変更された場合にもこの警告が表示されます。「警告ダイアログに表示されている、接続中の SSH サーバのホスト鍵の指紋」と「接続しようとしている SSH サーバのホスト鍵の正確な指紋」を比較してください。</p>

    <p>OpenSSH の場合、サーバ管理者は以下のようなコマンドでサーバのホスト鍵の指紋を取得できます。</p>

    <pre>ssh-keygen -l -f /etc/ssh/ssh_host_rsa_key.pub</pre>
-->

    <h3><a name="SSHFP">SSHFP RR</a></h3>

<!--
    <p>SSH 接続時に、RFC 4255 に規定されている SSHFP RR (Secure SHell FingerPrint Resource Record) による検証が可能ですが、現在のTera Termでは DNSSEC 認証ができないので参考程度の位置づけとなります。</p>

    <p>ドメインの所有者であれば DNS の SSHFP レコードに SSH サーバホスト鍵の署名を登録することが可能です。クライアント(Tera Term)は SSHFP レコードを取得し、接続中のサーバホスト鍵と比較することで検証が可能です。<br />
       この機能は Windows リゾルバの制限により Windows 2000 以降でのみ有効です。</p>

    <p>SSHFP に関して規定している RFC 4255 には「DNSSEC 認証されていない SSHFP RR を信頼してはならない」とあります。<br />
       Tera Termが利用しているWindows リゾルバは DNSSEC の署名が検証ができないため、常に DNSSEC 認証に失敗します。</p>
-->

    <h2><a name="generate">Generating Key</a></h2>

    <p>
     Here, we will describe how to generate Public/Private key.  To generate key, select [Setup]
menu and choose [SSH KeyGenerator...].
    </p>
    <div class="img"><img src="../image/SelectKeyGenerator.png" alt="Choosing key generation"></div>
    <p>
      Then you will see a dialog of key generation. 
    </p>
    <div class="img"><img src="../image/KeyGenerator.png" alt="Key generation dialog"></div>
    <p>
      [Key type] is to select key types - [RSA1] for SSH1 protocol and [RSA] or [DSA] for SSH2 protocol should be chosen respectively. After choosing key type, you will be prompted for pass phrase by clicking [Generate] button. Type in pass phrase (like a password, but it can include blank and usually much longer than password). Then click [Save public key]
button, [Save private key] button to save these keys. File name can be left as default if you don't need. At the completion, click [Cancel] to finish this process.
    </p>

    <p>
For this file, when it is saved as default, all files which have an extension of [pub] (public key) will be stored in the specified location in the server (usually, it is (home dir)/.ssh/authorized_keys). All files which have NOT an extension are recognized as private key and you have to specify it at login.
 </p>

    <p>
      <em>Note: </em>Since Private key should not be disclosed to other party, please be careful to make it secret. Please makre that it is NOT sent to server by accident.
    </p>

  </body>
</html>
