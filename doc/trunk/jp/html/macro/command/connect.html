<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<TITLE>connect</TITLE>
<link rel="stylesheet" href="../../style.css" type="text/css">
</HEAD>
<BODY>


<FONT SIZE="+2">connect</FONT><BR><BR>


形式：
<UL>
<B>
connect &lt;command line parameters&gt;
</B>
</UL><P></P>

<pre><P></P>
MACRO が Tera Term とリンクされていない場合、Tera Term を起動してMACRO とリンクする。<command line parameters> は、Tera Term 
を起動する時のコマンドラインパラメータ。

MACRO が Tera Term とすでにリンクされていて、Tera Term がホストに接続されていない場合、Tera Term をコマンドライン <command line parameters> 
で指定されるホストに接続させる。

Tera Term のコマンドラインパラメータについては、Tera Term ヘルプを参照。

MACRO が Tera Term とすでにリンクされていて、Tera Term がホストにすでに接続されている場合、このコマンドは無視される。

このコマンドの結果、リンクと接続の状態に応じて以下のうちの一つの値がシステム変数 result に格納される。
<P></P>
</pre><P></P>
<pre>
値						状態
<hr>
0						Tera Term とリンクされていない。
1						ホストへの接続はされていないが、Tera Term へのリンクはされている。
2						リンクおよび接続両方ともされている。

"connect" コマンドを実行する前にリンクと接続の状態を調べるには、"testlink" コマンドを使うことができる。

Tera Term と MACRO のリンクしていない状態では、"connect" と "testlink" 以外の通信コマンドは実行できない。




<pre>
There are 3 types of connection you can establish from TeraTerm macro: 

  - Telnet connection (port 23) 
  - SSH1 or SSH2 connection (port 22) 
  - General connection
  - Connection via COM port
  
Telnet connections:
  
  connect 'myserver:23 /nossh'
  or
  connect 'myserver:23 /telnet'
  or
  connect 'myserver:23'
  
  Using /nossh is strongly recommended. Without this parameter TeraTerm will start connecting with the same method (telnet or SSH) that was used during last time when teraterm.ini file was saved. In case it was SSH than your macro will try to connect via SSH and will eventually fail.
  
  
SSH connections:
  
  connect 'myserver /ssh'
  
  This way will start SSH connection without defining whether SSH1 or SSH2 has to be used.
  
  connect 'myserver /ssh /1'
  or
  connect 'myserver /ssh /2'
  
  Parameters /1 and /2 force to use SSH1 or SSH2 method.
  
  connect 'myserver /ssh /auth=password /user=username /passwd=password'
  or
  connect 'myserver /ssh /1 /auth=password /user=username /passwd=password'
  or
  connect 'myserver /ssh /2 /auth=password /user=username /passwd=password'
  or
  connect 'myserver /ssh /auth=publickey /user=username /passwd=password /keyfile=private-key-file'
  or
  connect 'myserver /ssh /1 /auth=publickey /user=username /passwd=password /keyfile=private-key-file'
  or
  connect 'myserver /ssh /2 /auth=publickey /user=username /passwd=password /keyfile=private-key-file'
  
  Above 6 ways allow to skip popup dialog and pass username and password directly from macro. Please note that /auth=password or /auth=publickey is the parameter saying that authentication will be done by entering password or private-key-file thus you should not replace the word 'password' or the word 'publickey' in it with actual password.
  Important note: The password can contain space character. To represent space inside the password replace it with @ character. If @ character itself is part of the password than it has to be replaced with 2 consecutive @ characters @@.
  Please remember that entering actual username and password in TeraTerm macro will cause them to be stored as an open text and it is your responsibility to keep such macro is secure location. 
  
  connect 'myserver /ssh /auth=password /user=username /ask4passwd'
  or
  connect 'myserver /ssh /1 /auth=password /user=username /ask4passwd'
  or
  connect 'myserver /ssh /2 /auth=password /user=username /ask4passwd'
  or
  connect 'myserver /ssh /auth=publickey /user=username /ask4passwd /keyfile=private-key-file'
  or
  connect 'myserver /ssh /1 /auth=publickey /user=username /ask4passwd /keyfile=private-key-file'
  or
  connect 'myserver /ssh /2 /auth=publickey /user=username /ask4passwd /keyfile=private-key-file'
  
  Above 6 ways pass username and authentication method directly from macro, and the popup asks for password.
  

General connection:

  connect 'myserver /timeout=&lt;value&gt;'
    
  Note: This option value is connecting timeout value(per seconds). Connecting to myserver 
  could be canceled after timeout has occurred with the specified value. Conversely, no action 
  if the value is zero. The default value is zero. Also this value would be saved as 
  `ConnectingTimeout' entry in teraterm.ini file.
  
Connections via COM port:
  
  connect '/C=x' 
  
  Here x represents COM port number. For example to connect via COM port 1 the command will look like: connect '/C=1'
</pre>



参照：
<UL>
<A HREF="closett.html">"closett"</A>
"disconnect"
"testlink"
"unlink"
</UL>

<pre>
例：
  	connect ''	パラメータなしで Tera Term を起動

	connect 'myserver /timeout=5'   Timeout will occur if connection does not succeed within five seconds.

	connect 'myserver:23 /nossh'	Run Tera Term and open telnet session

	connect 'myserver /ssh'	Run Tera Term and open SSH session

	connect 'myserver /ssh /1'	Run Tera Term and open SSH1 session

	connect 'myserver /ssh /2'	Run Tera Term and open SSH2 session

	connect 'myserver /ssh /auth=password /user=username /passwd=password'	Run Tera Term,open SSH session and do not prompt for user name and password**

	connect 'myserver /ssh /1 /auth=password /user=username /passwd=password'	Run Tera Term, open SSH1 session and do not prompt for user name and password**

	connect 'myserver /ssh /2 /auth=password /user=username /passwd=password'	Run Tera Term, open SSH2 session and do not prompt for user name and password**

	connect 'myserver /ssh /auth=publickey/user=username /passwd=password /keyfile=private-key-file'	Run Tera Term, open SSH session and, not prompt for user name and password** and use private key file

	connect 'myserver /ssh /1 /auth=publickey/user=username /passwd=password /keyfile=private-key-file'	Run Tera Term, open SSH1 session and, not prompt for user name and password**and use private key file

	connect 'myserver /ssh /2 /auth=publickey /user=username /passwd=password /keyfile=private-key-file'	Run Tera Term, open SSH2 session and, not prompt for user name and password** and use private key file

	connect '/C=x'	RunTera Term and open serial port connection. Port number is x=1..99

	CommandLine = '111.111.11.11'	
	connect CommandLine

<hr>
* In these examples parameters shown with Italic font have to be replaced with their actual values.

** The password can contain space character. To represent space inside the password replace it 
   with @ character. If @ character itself is part of the password than it has to be replaced 
   with 2 consecutive @ characters @@.

</BODY>
</HTML>

