<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>crc32</title>
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="../../style.css" type="text/css">
</head>

<body>


<h1>crc32</h1>

<p>
Calculates the CRC-32 of a string or a file.
</p>

<pre class="macro-syntax">
crc32 &lt;string&gt;
crc32file &lt;filename&gt;
</pre>

<h2>Remarks</h2>

<p>
This macro function calculates the CRC(Cyclic Redundancy Checking) of a string or a file. The polynomial expression(right rotation) is as follows:
<br><br>

100000100110000010001110110110111 (x<sup>32</sup>+x<sup>26</sup>+x<sup>23</sup>+x<sup>22</sup>+x<sup>16</sup>+x<sup>12</sup>+x<sup>11</sup>+x<sup>10</sup>+x<sup>8</sup>+x<sup>7</sup>+x<sup>5</sup>+x<sup>4</sup>+x<sup>2</sup>+x<sup>1</sup>+x<sup>0</sup>)
<br><br>

The calculated value stores the system variable "result" as mathematical value.
</p>


The CRC algorithm implementation is as follows:
<pre class="macro-example">
<code>
#define CRCPOLY2 0xEDB88320UL  /* left-right reversal */

static unsigned long crc2(int n, unsigned char c[])
{
	int i, j;
	unsigned long r;

	r = 0xFFFFFFFFUL;
	for (i = 0; i < n; i++) {
		r ^= c[i];
		for (j = 0; j < CHAR_BIT; j++)
			if (r & 1) r = (r >> 1) ^ CRCPOLY2;
			else       r >>= 1;
	}
	return r ^ 0xFFFFFFFFUL;
}
</code></pre>


<h2>Example</h2>

<pre class="macro-example">
<code>
str = 'this is a test string to be CRC32ed'
crc32 str

; Display CRC32 result asHEX
sprintf '0x%08X' result
messagebox inputstr 'CRC32 = '

crc32file 'foo.bin'
sprintf '0x%08X' result
messagebox inputstr 'CRC32 = '
</code></pre>

</body>
</html>
