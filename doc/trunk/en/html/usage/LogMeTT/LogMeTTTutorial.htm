<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="../../style.css" type="text/css">
<title>LogMeTT Tutorial</title>
</head>

<body>

<h1>LogMeTT Tutorial</h1>

<h1>TBD</h1>



<h2>1. What is LogMeTT?</h2>

<p>LogMeTT is a launcher application for TeraTerm -terminal emulator- macro. The user can automatically login to the remote host, also can do any procedure on the server. Already here is `TeraTerm Menu' as auto-login application, however LogMeTT has more feature than TeraTerm Menu. There are many features like as SSH2 connection, scheduling, auto logging, and color setup per the remote host. And also, LogMeTT can have the tree repository per a macro file. LogMeTT author is <a href="http://www.neocom.ca/">Boris</a> living in USA. LogMeTT has been included in TeraTerm package.</p>


<h2>2. What can LogMeTT do?</h2>

<p>The user can administrate some automatic connection to remote hosts by using LogMeTT. Also the user can effectively administrate these configuration because the user can register these host informations as a tree repository. However, LogMeTT does not have the feature like as quick launching by keyboard shortcut.</p>


<h2>3. How to launch</h2>

<p>LogMeTT can be launched on File menu of TeraTerm. When the application is launched, LogMeTT icon will appear in the notification area, at the far right of the taskbar.</p>

<div class="img"><img class="block" width="209" height="29" src="tasktray.jpg" alt="tasktray"></div>




<h2>4. Configuration</h2>

<p>Here's the part LogMeTT configurations are introduced. The user will experience the great thing to do auto login to the remote host by using TeraTerm.</p>

<p>1. Right-click to select LogMeTT icon in the notification area -see upper 3. figuare, and then select "Configure...".</p>

<p>2. Configuration dialog appears. Click the "Settings" tab, and then on the "Settings" tab, select the "Run at log on to Windows" check box. If so, LogMeTT would automatically be launched on Windows logon.</p>

<p>3. When &quot;Start logging&quot; is checked on New Connections tab under Settings tab, auto logging will start by launching TeraTerm macro.<br>
The log format is `TeraTerm installation directory\Logs\LogMeTT<i>menu name</i>_<i>timestamp</i>.log'.</p>

<div class="img"><img width="652" height="529" src="setting_logon.jpg" alt="logon"></div>



<p>4. When the user selects "Add Child" under "Connection" menubar, a entry will be added. And, the user also can select "Add Child" by right-click "This computer" on screen left.</p>

<p>5. Next, "Unnamed connection #1" icon will add under "This computer", select the icon and rename by F2 key.</p>


<div class="img"><img width="654" height="530" src="setting_add.jpg" alt="add"></div>

<p>6. Select "Macro" tab, and then describe the macro script to login to the remote host. If you want to fix the user name and to make the user input the user's password on dialog box, refer to in the following macro script. Alternative, you can directly write the user's password in the macro file, take care of it.<br>*NOTICE* Refer to 5. section about the security conscious macro.
</p>

<pre class="code">
username = 'nike'
hostname = '192.168.1.3'

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

msg = 'Enter password for user '
strconcat msg username
passwordbox msg 'Get password'

msg = hostname
strconcat msg ':22 /ssh /auth=password /user='
strconcat msg username
strconcat msg ' /passwd='
strconcat msg inputstr

connect msg
</pre>

<div class="img"><img width="654" height="558" src="macro.jpg" alt="macro"></div>

<p>7. Push F9 key, verify to work your macro script. If it is all right, save the macro script to the file by pushing Apply button at upper right direction.
</p>

<!--

<p>8. 登録したリモートホストはタスクトレイの右クリックメニューから選択することができる。</p>

<p>9. “Popup”タブにメッセージを記述しておくと実行時に、</p>

<div class="img"><img width="654" height="473" src="popup.jpg" alt="popup"></div>

<p>下記のポップアップメッセージが表示される。</p>

<div class="img"><img width="193" height="117" src="popup2.jpg" alt="popup"></div>

<p>重要なホストに接続する際や、root等の特権アクセスのマクロにPopupで注意を促す際等に利用する。ポップアップメッセージではOKを押すとマクロが実行され、Cancelを押すとMacroは実行されない。</p>

<p>10.” Colors”タブでは、接続メニュー毎にTeraTermの配色を変更できる。 Popup同様、重要なホストに接続する際等のメニュー配色を変えるなどに利用する。ユーザ毎、ホスト毎に配色を変更する事で誤操作の予防にもなる。</p>

<div class="img"><img width="653" height="506" src="color.jpg" alt="color"></div>

<p>11. Scheduleタブでは、設定したマクロを自動実行させることができる。 上手くマクロを組めば、下記のような事が可能になる。</p>

<ul>
  <li>定期的に電源をon/off</li>
  <li>“Settings”タブの”User Data”タブ項目と組み合わせ、障害発生時にe-mailや電話させるなどの自動処理</li>
  <li>定時バックアップ、ステータスチェック</li>
</ul>

<p class="warning">※注意:メニューの階層は親から順番に実行されてしまうため、子をスケジュールに入れておくとその直系親ツリーがすべて実行される。単一タスクとして行いたい場合は独立させること（This computer直下)。また、ホストとLogMeTTを実行するPCの時刻差異に注意すること。</p>

<p class="notice">Scheduleを実行する場合は、後述の自動ログをONにすることを推奨する。(後で何が起きたかわからなくなってしまわないように)</p>



<h2>セキュリティに配慮したマクロについて</h2>

<p>この項目は、TeraTerm Macroに関するTopicです。</p>

<p>”4. 設定”で紹介したマクロではマクロ内にユーザ名が記述されており、セキュリティ上あまり良くないと思われます。パスワードは毎回入力するタイプです。これを、ユーザ名、パスワードを暗号化したファイルに保存する方式を紹介します。</p>

<h3>1. パスワードを暗号化して記憶（ローカル保存）するマクロ＝自動ログイン</h3>

<p>※ユーザ名を <span class="variable">scott</span> ホスト名を <span class="variable">remote.host</span> パスワードファイルの保存先を <span class="variable">C:\mydata\filename.dat</span> とした場合のマクロ例です。</p>

<pre class="code">
; setting
hostname = 'remote.host'
username = 'scott'
getpassword 'C:\mydata\filename.dat' 'usrpass' inputstr

; connection &amp; login
msg = hostname
strconcat msg ':22 /ssh /2 /auth=password /user='
strconcat msg usernam
strconcat msg ' /passwd='
strconcat msg inputstr
connect msg
</pre>

<p>※getpassword 'filepath\filename' '識別子' $格納変数</p>

<p>同一格納ファイルに複数の識別子でパスワードを暗号化保存できます。</p>

<p>このマクロは、最初の一度だけパスワードを聞かれますが、その後はC:\mydata\filename.datに保存された暗号化パスワードが利用されるためLogMeTTメニューからの選択だけで自動ログインが可能になります。</p>


<h3>2. ユーザIDとパスワードを両方暗号化して記憶（ローカル保存）するマクロ＝自動ログイン</h3>

<p>ホスト名を <span class="variable">remote.host</span> ユーザIDとパスワードファイルの保存先を <span class="variable">C:\mydata\filename.dat</span> とした場合のマクロ例です。</p>

<pre class="code">
; setting
hostname = 'remote.host'
getpassword 'C:\mydata\filename.dat' 'usrid' username
getpassword 'C:\mydata\filename.dat' 'usrpass' inputstr

; connection &amp; login
msg = hostname
strconcat msg ':22 /ssh /2 /auth=password /user='
strconcat msg username
strconcat msg ' /passwd='
strconcat msg inputstr
connect msg
</pre>

<p>※getpassword 'filepath\filename' '識別子' $格納変数</p>

<p>このマクロではユーザIDも識別子usridとして格納しています。最初のログイン時にはユーザIDとパスワードの両方を入力しなければなりませんが、2回目以降は同様にLogMeTTメニューからの選択だけで自動ログインが可能になります。同じように、getpasswordを利用することでホスト名を暗号化してしまうことも可能ですが、TeraTermのヒストリに過去接続したホストが残る場合もありますのでセキュリティを考慮する場合は様々な注意が必要です。ホスト名、そのホストに登録されているID、パスワード等のすべてを暗号化して隠すことができるマクロです。</p>


<h3>3. telnetを利用する場合</h3>

<p>telnet(ポート23)を利用して接続する場合は接続マクロが一部違いますので注意してください。<br>
これは、telnetが接続セッション確立後に認証を行うためです。</p>

<pre class="code">
; setting
hostname = 'remote.host'
getpassword 'C:\mydata\filename.dat' 'usrid' username
getpassword 'C:\mydata\filename.dat' 'usrpass' inputstr
;; login session ※
UsernamePrompt = 'Please login:'
PasswordPrompt = 'Please Enter password:'

; connection
msg = hostname
strconcat msg ':23'
strconcat msg ' /nossh'
connect msg

; login
wait   UsernamePrompt
sendln username
wait   PasswordPrompt
sendln inputstr
</pre>

<p>※telnetではログインするホストの応答内容にあわせて記述を変更する必要があります。(ログインプロンプト)</p>


<h3>暗号化して記憶（ローカル保存）したファイルの取り扱いについて</h3>

<p>保存されたパスワードファイルを安全に保管することで、たとえばrootユーザで接続する場合はそのファイルが必要になるような運用を行うことができます。管理者は最初に一度だけ複雑で長いパスワードを設定し、ファイル保存後は破棄してしまってかまわないのです。</p>

<p>
上記のマクロ例のようにローカル保存する場合は、セキュリティの観点からスタートアップにパスワード格納ファイルの削除バッチファイルを入れておくと、ログイン後最初の一度だけパスワード認証が必要になり、セキュリティと利便性の両立などを図ることができます。</p>

<p>完全なセキュリティはありませんが、機密性を強化するのに役立ててください。</p>

<h2>6. 最新版の入手先</h2>

<p>TeraTermに付属しているLogMeTTは基本的にリリース時点での最新版を同梱するようにしていますが、別プロダクトですのでリリースによってはLogMeTTの最新版が先に提供されることもあります。最新版の<a
href="http://www.neocom.ca/forum/viewforum.php?f=5">ダウンロードはこちら</a></p>

<p>また、LogMeTTのメニュー”Help“から”Check for updates”を選択しても最新版を入手可能です。</p>

-->


<h2>7. Contact address</h2>

<p>
e-mail: boris at neocom.ca <br>
<a href="http://neocom.ca/freeware/LogMeTT/">LogMeTT web page</a>
</p>


</body>
</html>
